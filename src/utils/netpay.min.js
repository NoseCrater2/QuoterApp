(function(){var I={}.hasOwnProperty;var n=this.NetPay;var D=function(a,d){function c(){this.constructor=d}for(var g in a)I.call(a,g)&&(d[g]=a[g]);return c.prototype=a.prototype,d.prototype=new c,d.__super__=a.prototype,d};n=this.NetPay=function(){function a(){}function d(b,e,f,k,t){clearTimeout(e);e=null;f=f||"Unknown error";k=k||0;try{e=JSON.parse(t||"{}")}catch(u){f="Response error"}b({message:f,status:k,data:e,toString:function(){return this.message+" [status "+this.status+"]"}})}function c(b,
    e){return void 0===b||/^sk_[a-z0-9]+$/i.test(b)||null==b?d(e,null,"Empty or invalid NetPay Private Key",!1):!0}function g(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}function q(){var b=new XMLHttpRequest;b.overrideMimeType("application/json");b.open("GET","https://docs.netpay.mx/lookup/ipaddress/",!1);b.onload=function(){a.requestData=JSON.parse(b.responseText)};b.send(null)}function m(b,e,f,k,t){var u=g();""!=a.ipAddress?f.ipAddress=a.ipAddress:(q(),f.ipAddress=
a.requestData.ip);4<=f.expYear.length&&(f.expYear=f.expYear.substring(2,4));var p=JSON.stringify(f);u.onreadystatechange=function(v){4===this.readyState&&(200===this.status||201===this.status?d(k,null,{data:v.srcElement.responseType&&"text"!==v.srcElement.responseType?"document"===v.srcElement.responseType?v.srcElement.responseXML:v.srcElement.response:v.srcElement.responseText,deviceFingerPrint:f.deviceFingerPrint}):d(t,null,"An error occured while trying to call the NetPay tokenization method",
!1))};u.open("POST",b,!1);u.setRequestHeader("Authorization",e);u.setRequestHeader("Content-Type","application/json");u.send(p)}function h(b,e,f,k,t){k=g();k.onreadystatechange=function(p){4===this.readyState&&(a.requestData=200===this.status||201===this.status?{result:"success",errorCode:"000",data:JSON.parse(p.srcElement.responseType&&"text"!==p.srcElement.responseType?"document"===p.srcElement.responseType?p.srcElement.responseXML:p.srcElement.response:p.srcElement.responseText)}:{result:"error",
errorCode:"002",errorMsg:"Error al realizar la transacci\u00f3n."})};k.open("POST",b,!1);k.setRequestHeader("Authorization",e);k.setRequestHeader("Content-Type","application/json");if(null!=f)var u=JSON.stringify(f);k.send(u)}return a.version=1,a.sandboxMode=!1,a.productionURL="https://suite.netpay.com.mx/gateway-ecommerce",a.sandboxURL="https://gateway-154.netpaydev.com/gateway-ecommerce",a.productionOrgId="9ozphlqx",a.sandboxOrgId="45ssiuz3",a.mid="netpaymx_retail",a.ipAddress="",a.sandboxEmail=
"accept@netpay.com.mx",a.productionEmail="null@cybersource.com",a.createTokenURL="/v3/token",a.chargeUrl="/v3/charges",a.statusUrl="/v1/transaction-report/transaction/",a.setSandboxMode=function(b){a.sandboxMode=!!b},a.setIpAddress=function(b){a.ipAddress=b},a.getSandboxMode=function(){return a.sandboxMode},a.setApiKey=function(b){a.key=b},a.getApiKey=function(){return a.key},a.setPrivateKey=function(b){a.privateKey=b},a.getPrivateKey=function(){return a.privateKey},a.setBillEmail=function(b){a.billEmail=
b},a.getBillEmail=function(){return a.billEmail},a.setFolio=function(b){a.folio=b},a.getFolio=function(){return a.folio},a.setAmount=function(b){a.amount=b},a.getAmount=function(){return a.amount},a.setProductName=function(b){a.productName=b},a.getProductName=function(){return a.productName},a.setRedirect3dsUri=function(b){a.redirect3dsUri=b},a.getRedirect3dsUri=function(){return a.redirect3dsUri},a.setTransactionToken=function(b){a.transactionToken=b},a.getTransactionToken=function(){return a.transactionToken},
a.confirm=function(b,e){c(this.privateKey,e)&&(""!=a.transactionToken&&null!=a.transactionToken?(h((a.sandboxMode?a.sandboxURL:a.productionURL)+a.chargeUrl+"/"+a.transactionToken+"/confirm",a.privateKey,b,e),"success"==a.requestData.result&&null!=a.requestData.data.status&&"success"==a.requestData.data.status?d(b,null,{data:a.requestData}):d(e,null,a.requestData.errorMsg,!1)):d(e,null,"El calor del token de la transaccion est\u00e1 vacio.",!1))},a.log=function(b){"object"==typeof b&&"toString"in b&&
(b=b.toString());"undefined"!=typeof console&&"log"in console&&console.log(b)},a.validate=function(b,e){if(!b)throw e+" required";if("object"!=typeof b)throw e+" invalid";},a.formatData=function(b,e){return b},a.send=function(b,e,f,k,t){b=this.key;if(void 0===b||/^pk_[a-z0-9]+$/i.test(b)||null==b?d(k,null,"Empty or invalid NetPay ID",!1):1)if(a.card.validateNumber(e.cardNumber)||d(k,null,"Empty or invalid card number",!1))if(a.card.validateExpiry(e.expMonth,e.expYear)||d(k,null,"Empty or invalid expiry date",
!1))if(a.card.validateCVV(e.cvv2,e.cardNumber)||d(k,null,"Empty or invalid cvv",!1))if(/^[a-z0-9]+$/i.test(e.deviceFingerPrint)||d(k,null,"Empty or invalid fingerprint",!1))if(b=a.sandboxMode?a.sandboxURL:a.productionURL,t)c(this.privateKey,k)&&(""!=a.ipAddress?e.ipAddress=a.ipAddress:(q(),e.ipAddress=a.requestData.ip),4<=e.expYear.length&&(a.card.expYear=e.expYear.substring(2,4)),t=a.sandboxMode?0<a.getBillEmail().length?a.getBillEmail():a.sandboxEmail:a.productionEmail,h(b+a.createTokenURL,a.key,
e,f,k),"success"==a.requestData.result?(h(b+a.chargeUrl,a.privateKey,{description:a.productName,source:a.requestData.data.token,paymentMethod:"card",amount:a.amount,currency:"MXN",billing:{firstName:"NoReal",lastName:"Name",email:t,phone:"650-965-6000",address:{city:"Mountain View",country:"US",postalCode:"94043",state:"CA",street1:"1295 Charleston Road",street2:""},merchantReferenceCode:a.folio},redirect3dsUri:a.redirect3dsUri},f,k),"success"==a.requestData.result?"review"==a.requestData.data.status?
window.location=a.requestData.data.returnUrl:"failed"==a.requestData.data.status?d(k,null,a.requestData.data.error,!1):"success"==a.requestData.data.status?d(f,null,{data:a.requestData}):d(k,null,a.requestData.data.error,!1):d(k,null,a.requestData.errorMsg,!1)):d(k,null,a.requestData.errorMsg,!1));else return m(b+a.createTokenURL,a.key,e,f,k)},a}.call(this);this.NetPay.card=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return D(a,d),d.validateNumber=function(c){return c=
(c+"").replace(/\s+|-/g,""),/^\d+$/.test(c)&&10<=c.length&&19>=c.length&&d.validateLuhn(c)&&d.validateNumberLength(c)},d.validateLuhn=function(c){for(var g=(c+"").split(""),q=parseInt(g[c.length-1]),m=g.length-2,h=1;0<=m;m--,h++)c=parseInt(g[m]),0!=h%2&&9<(c*=2)&&(c-=9),q+=c;return 0==q%10},d.validateCVV=function(c,g){switch(arguments.length){case 1:return c=n.tools.trim(c),/^\d+$/.test(c)&&3<=c.length&&4>=c.length;case 2:return"American Express"==d.issuerName(g)?(c=n.tools.trim(c),/^\d+$/.test(c)&&
4==c.length):(c=n.tools.trim(c),/^\d+$/.test(c)&&3==c.length);default:return!1}},d.validateExpiry=function(c,g){var q,m;return 2===(g=n.tools.trim(g)).length&&(g="20"+g),c=n.tools.trim(c),!!/^\d+$/.test(c)&&!!/^\d+$/.test(g)&&12>=parseInt(c,10)&&1<=parseInt(c,10)&&(m=new Date(g,c),q=new Date,m.setMonth(m.getMonth()-1),m.setMonth(m.getMonth()+1,1),m>q)},d.validateNumberLength=function(c){var g;if(g=d.issuer(c)){for(var q=g.length.length;q--;)if(g.length[q]==c.length)return!0;return!1}return 10<=c.length&&
19>=c.length},d.issuerName=function(c){var g;return c&&(g=d.issuer(c))?g.name:""},d.types=function(){return{visa_electron:{name:"Visa Electron",regx:/^(4026|417500|4508|4844|491(3|7))/,length:[16],icon:"https://i.ibb.co/WD28yGh/visa-electron-logo.png",accept:!0},visa:{name:"Visa",regx:/^4/,length:[16],icon:"https://i.ibb.co/jbKNvPf/icons8-visa.png",accept:!0},mastercard:{name:"Mastercard",regx:/^5[1-5]/,length:[16],icon:"https://i.ibb.co/HhLhx0N/master-card-logo.png",accept:!0},mc:{name:"Mastercard",
regx:/^2[0-8]/,length:[16],icon:"https://i.ibb.co/HhLhx0N/master-card-logo.png",accept:!0},amex:{name:"American Express",regx:/^3[47]/,length:[15],icon:"https://i.ibb.co/4RDSYMc/amex-logo.png",accept:!0}}},d.issuer=function(c){var g=d.types();for(var q in g){var m=g[q];if(m,c.match(m.regx))return m}return!1},d}.call(this,this.NetPay);this.NetPay.token=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return D(a,d),d.create=function(c,g,q,m){return n.validate(c,"tarjeta"),
n.formatData(c,d.whitelistedAttrs),n.send("tokens",c,g,q,m)},d}.call(this,this.NetPay);this.NetPay.tools=function(a){function d(){}return D(a,d),d.trim=function(c){return(c+"").replace(/^\s+|\s+$/g,"")},d}.call(this,this.NetPay);this.NetPay.form=function(a){function d(){}function c(h,b){var e=document.createElement(h);b.style&&(e.style=b.style);b.innerHTML&&(e.innerHTML=b.innerHTML);b.placeholder&&(e.placeholder=b.placeholder);b.maxLength&&(e.maxLength=b.maxLength);b.type&&(e.type=b.type);b.src&&
(e.src=b.src);b.width&&(e.width=b.width);b.id&&(e.id=b.id);return e}function g(h,b,e){var f=document.createElement("script");f.src="https://h.online-metrix.net/fp/tags.js?org_id="+h+"&session_id="+e;f.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(f);f=document.createElement("iframe");f.setAttribute("id","iframeTM");f.style.width="100px";f.style.height="100px";f.style.border="0";f.style.position="absolute";f.style.top="-5000px";f.src="https://h.online-metrix.net/fp/tags?org_id="+
h+"&session_id="+b+e;document.body.appendChild(f);return e}function q(){var h=document.head||document.getElementsByTagName("head")[0],b=document.createElement("style");h.appendChild(b);b.type="text/css";b.styleSheet?b.styleSheet.cssText="input:focus, textarea:focus, select:focus{ outline: none; }":b.appendChild(document.createTextNode("input:focus, textarea:focus, select:focus{ outline: none; }"))}function m(h,b,e,f){h.disabled=!b;h.style=b?e:f}return D(a,d),d.generate=function(h,b,e,f,k){k=void 0===
k?!1:k;f=f||{};var t,u,p,v,F,w,y,z,G,A=!1,B=!1,C=!1,E=document.getElementById(h);E.innerHTML="";var J=g(n.sandboxMode?n.sandboxOrgId:n.productionOrgId,n.mid,(new Date).getTime());E.style="width: 300px; max-width: 100%; margin: 0 auto; font-family: Verdana,Geneva,sans-serif; padding: 20px; box-sizing: border-box; border: 1px solid #EDEDED;  border-radius: 7px;  background-color: #F5F7FA;  box-shadow: 0 5px 10px 0 rgba(194,194,194,0.5);";E.appendChild(h=c("form",{}));h.remote=!0;q();var x=c("div",{style:"text-align: right"});
x.appendChild(c("img",{src:"https://docs.netpay.mx/mails/assets/ic_secured.svg"}));x.appendChild(c("img",{src:"https://docs.netpay.mx/mails/assets/pci.svg"}));var H=c("div",{style:"text-align: left; margin-bottom: 14px;"});H.appendChild(c("img",{src:"https://docs.netpay.mx/cdn/assets/img/POS_logo.png",width:70}));h.appendChild(x);h.appendChild(H);h.appendChild(c("h1",{style:"color: #435365; font-size: 15px;  font-weight: bold;  letter-spacing: 0;  line-height: 18px; margin-bottom: 20px;",innerHTML:f.title||
"Pago con Tarjeta"}));h.appendChild(c("label",{style:"height: 18px; width: 6px; color: #FF6260; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 18px;",innerHTML:"*"}));h.appendChild(c("label",{style:"color: #435365; font-family: .SF NS Display; font-size: 13px; letter-spacing: 0; line-height: 18px; margin-top: 18px; margin-bottom: 5px;",innerHTML:"N\u00famero tarjeta de d\u00e9bito/cr\u00e9dito:"}));x=c("div",{style:"height: 0; overflow: visible; width: 0; position: relative; float: right; right: 40px; top: 28px;"});
x.appendChild(u=c("img",{src:"",width:30}));h.appendChild(x);h.appendChild(t=c("input",{style:"width: 100%; border: 1px solid #CECECE; border-radius: 3px; background-color: #FFFFFF; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 17px; padding: 10px 10px 10px 9px; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",type:"text",placeholder:"0000-0000-0000-0000",maxLength:19}));h.appendChild(c("label",{style:"height: 18px; width: 6px; color: #FF6260; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 18px;",
innerHTML:"*"}));h.appendChild(c("label",{style:"color: #435365; font-family: .SF NS Display; font-size: 13px; letter-spacing: 0; line-height: 18px; margin-top: 18px; margin-bottom: 5px;",innerHTML:"Fecha de vencimiento:"}));h.appendChild(v=c("input",{style:"width: 100%; border: 1px solid #CECECE; border-radius: 3px; background-color: #FFFFFF; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 17px; padding: 10px 10px 10px 9px; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",
type:"text",placeholder:"MM/AA",maxLength:5}));h.appendChild(c("label",{style:"height: 18px; width: 6px; color: #FF6260; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 18px;",innerHTML:"*"}));h.appendChild(c("label",{style:"color: #435365; font-family: .SF NS Display; font-size: 13px; letter-spacing: 0; line-height: 18px; margin-top: 18px; margin-bottom: 5px;",innerHTML:"C\u00f3digo de seguridad:"}));h.appendChild(F=c("input",{style:"width: 100%; border: 1px solid #CECECE; border-radius: 3px; background-color: #FFFFFF; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 17px; padding: 10px 10px 10px 9px; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",
type:"password",placeholder:"CVV",maxLength:4}));E.appendChild(p=c("button",{style:"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px;",innerHTML:f.submitText||"Pagar"}));p.onclick=function(){var l={cardNumber:w,expMonth:y,expYear:z,cvv2:G,deviceFingerPrint:J,
ipAddress:""};p.innerHTML="Procesando...";p.disabled=!0;p.style="border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px; opacity: 50%;";t.disabled=!0;v.disabled=!0;F.disabled=!0;n.token.create(l,b,e,k)};m(p,!1,"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px;",
"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px; opacity: 50%;");t.addEventListener("input",function(l){w=l.target.value.replace(/\D/g,"");var r=w.match(/.{1,4}/g)||[""];l.target.value=r.join("-");r=n.card.issuer(l.target.value);n.card.validateNumber(w)||
""==l.target.value?(l.target.style="width: 100%; border: 1px solid #CECECE; border-radius: 3px; background-color: #FFFFFF; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 17px; padding: 10px 10px 10px 9px; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",B=!0):(l.target.style="width: 100%; border: solid 1px; border-radius: 3px; padding: 10px 10px 10px 9px; font-size: 15px; border-color: red; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",
B=!1);u.src=r?r.icon:"";m(p,B&&A&&C,"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px;","border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px; opacity: 50%;")});
t.addEventListener("focus",function(l){if(1<l.target.value.length){var r=w.match(/.{1,4}/g)||[""];l.target.value=r.join("-")}});t.addEventListener("blur",function(l){var r=l.target.value.replace(/\D/g,"");n.maskCard=r.replace(/.(?=.{4})/g,"*");r=n.maskCard.match(/.{1,4}/g)||[""];l.target.value=r.join("-")});v.addEventListener("keyup",function(l){var r=l.target.value.replace(/\D/g,"").match(/.{1,2}/g);r?(l.target.value=r.join("/"),2==r.length?(y=r[0],z=r[1],n.card.validateExpiry(y,z)?(l.target.style=
"width: 100%; border: 1px solid #CECECE; border-radius: 3px; background-color: #FFFFFF; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 17px; padding: 10px 10px 10px 9px; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",A=!0):(l.target.style="width: 100%; border: solid 1px; border-radius: 3px; padding: 10px 10px 10px 9px; font-size: 15px; border-color: red; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",A=!1)):z=y=null):(l.target.style=
"width: 100%; border: 1px solid #CECECE; border-radius: 3px; background-color: #FFFFFF; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 17px; padding: 10px 10px 10px 9px; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",z=y=null);m(p,B&&A&&C,"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px;",
"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px; opacity: 50%;")});F.addEventListener("keyup",function(l){1<l.target.value.length&&(G=l.target.value,n.card.validateCVV(G,w)?(l.target.style="width: 100%; border: 1px solid #CECECE; border-radius: 3px; background-color: #FFFFFF; font-family: .SF NS Display; font-size: 14px; letter-spacing: 0; line-height: 17px; padding: 10px 10px 10px 9px; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",
C=!0):(l.target.style="width: 100%; border: solid 1px; border-radius: 3px; padding: 10px 10px 10px 9px; font-size: 15px; border-color: red; box-sizing : border-box; margin-bottom: 18px; margin-top: 5px;",C=!1));m(p,B&&A&&C,"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px;",
"border-radius: 3px;  background-color: #435365;  box-shadow: 0 2px 5px 0 rgba(101,101,101,0.3); color: #FFFFFF; font size: 14px; font-weight: 600; letter-spacing: 0; line-height: 19px; text-align: center; margin-top: 20px; width: 100%; height: 40px; border: 1px; box-sizing : border-box; margin-bottom: 48px; opacity: 50%;")})},d}.call(this,this.NetPay);"object"===typeof module&&"undefined"!==typeof exports&&(module.exports=this.NetPay)}).call(this);